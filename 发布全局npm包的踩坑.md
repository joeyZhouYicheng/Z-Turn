# 发布全局npm包的踩坑

写了一个可以半自动提交git的脚本，想让更多人也能使用，就打算提交到`npm`，变成一个人人可下载的包。

### 注册npm

[官网](https://www.npmjs.com/)就能注册了，不过留的邮箱不能是国内邮箱。打开验证邮箱的链接会变成404，这就没法验证邮箱，也没法上传了。

### Package.json

一个光秃秃的`js`文件是不能上传的，因为别人也不知道你这个文件需要什么依赖、怎么用之类的。

可以先`npm init -y`，初始化一个`package.json`文件，大部分设置都会给你设置好，你只需要额外添加一些信息。

比如说，`author`，`keywords`之类的。

如果你这是一个需要全局运行的命令，那么可以加一行`bin`

```json
...
"bin": {
    "sag": "index.js"
},
...
```

这是我加入`package.json` 的一段。

如果在本地，运行`npm link`，就会生成这个全局的命令。在命令行输入`sag`，相当于在那个文件夹运行`node index.js`这个脚本。

如果别人全局下载了这个npm包，那么通过这个设置就能直接用这个命令来运行`index.js`这个脚本。

[参考](https://segmentfault.com/a/1190000012915226)

### 包名

包名和别人的冲突，就无法上传。可以先在命令行输入：

```shell
npm view <你的包名>
```

来验证这个包是否存在。

如果不存在，就会报错，你就能将其作为自己的包名，并上传了。

### 发布

[参考](https://juejin.im/post/5b95c2ed6fb9a05cd67699d1)

你需要先登录一下，`npm login`

`npm publish` 就能发布了，